<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Orange Pi WiFi Setup</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <div class="container">
  <h1>üì° Wi-Fi –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h1>

  <button onclick="scanWifi()">üîç –°–∫–∞–Ω—É–≤–∞—Ç–∏ Wi-Fi</button>

  <ul id="wifi-list"></ul>

  <input id="ssid" placeholder="SSID" readonly>
  <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button onclick="connect()">üîó –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—å</button>
</div>

<script>
  let autoScanTimer = null;

  function signalIcon(level) {
    if (level > 80) return "‚ñÇ‚ñÑ‚ñÜ‚ñà";
    if (level > 60) return "‚ñÇ‚ñÑ‚ñÜ";
    if (level > 40) return "‚ñÇ‚ñÑ";
    return "‚ñÇ";
  }

  function scanWifi() {
    fetch("/scan")
      .then(r => r.json())
      .then(data => {
        const list = document.getElementById("wifi-list");
        list.innerHTML = "";

        data.forEach(net => {
          const li = document.createElement("li");
          if (net.in_use) li.classList.add("active");

          li.onclick = () => {
            document.getElementById("ssid").value = net.ssid;
          };

          li.innerHTML = `
            <div>
              <div class="ssid">
                ${net.ssid}
                ${net.secure ? "üîí" : ""}
                ${net.in_use ? " ‚≠ê" : ""}
              </div>
              <div class="meta">${net.signal}%</div>
            </div>
            <div class="signal">${signalIcon(net.signal)}</div>
          `;

          list.appendChild(li);
        });
      });
  }

  /* üîÑ –∞–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥ */
  function startAutoScan() {
    scanWifi();
    autoScanTimer = setInterval(scanWifi, 10000);
  }

  window.onload = startAutoScan;
</script>
</body>
</html>
